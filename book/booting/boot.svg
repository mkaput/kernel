<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="760" height="1006" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: Entering krnl_main

participant BIOS\nUEFI as BIOS
participant CDROM
participant GRUB
participant Kernel\n(ASM) as ASM
participant Kernel\n(Rust) as Rust

BIOS-->CDROM: Load 1st sector
CDROM-->BIOS:
BIOS->CDROM: Jump to\n1st sector
CDROM-->GRUB: Read rest of\nthe image
GRUB-->CDROM:
CDROM->GRUB: Jump to\nGRUB Kernel
GRUB-->BIOS: Fetch system information
BIOS-->GRUB:
Note over GRUB: Enter protected mode
GRUB-->>CDROM: Load grub.cfg
CDROM-->GRUB:
Note over GRUB: Show boot screen
GRUB-->ASM: Load kernel.bin
ASM-->GRUB:
Note over GRUB: Fill Multiboot\ninfo table
GRUB->ASM: Jump to\nkrnl_start32
Note over ASM: Perform basic system checks,\nprepare min. environment for\nRust code, enter long mode\nand far jump to krnl_start64
ASM->Rust: Call krnl_main]]></source><desc>Entering krnl_main</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="190" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="15" y="30" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="15">Entering krnl_main</tspan></text></g><g class="actor"><rect x="10" y="49" width="60" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="74" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">BIOS</tspan><tspan dy="1.2em" x="20">UEFI</tspan></text></g><g class="actor"><rect x="10" y="927.8000106811523" width="60" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="952.8000106811523" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">BIOS</tspan><tspan dy="1.2em" x="20">UEFI</tspan></text></g><line x1="40" x2="40" y1="107.20000076293945" y2="927.8000106811523" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="175" y="49" width="70" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="185" y="83.60000038146973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="185">CDROM</tspan></text></g><g class="actor"><rect x="175" y="927.8000106811523" width="70" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="185" y="962.4000110626221" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="185">CDROM</tspan></text></g><line x1="210" x2="210" y1="107.20000076293945" y2="927.8000106811523" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="330" y="49" width="60" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="340" y="83.60000038146973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="340">GRUB</tspan></text></g><g class="actor"><rect x="330" y="927.8000106811523" width="60" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="340" y="962.4000110626221" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="340">GRUB</tspan></text></g><line x1="360" x2="360" y1="107.20000076293945" y2="927.8000106811523" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="490" y="49" width="80" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="500" y="74" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="500">Kernel</tspan><tspan dy="1.2em" x="500">(ASM)</tspan></text></g><g class="actor"><rect x="490" y="927.8000106811523" width="80" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="500" y="952.8000106811523" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="500">Kernel</tspan><tspan dy="1.2em" x="500">(ASM)</tspan></text></g><line x1="530" x2="530" y1="107.20000076293945" y2="927.8000106811523" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="650" y="49" width="80" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="660" y="74" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="660">Kernel</tspan><tspan dy="1.2em" x="660">(Rust)</tspan></text></g><g class="actor"><rect x="650" y="927.8000106811523" width="80" height="58.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="660" y="952.8000106811523" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="660">Kernel</tspan><tspan dy="1.2em" x="660">(Rust)</tspan></text></g><line x1="690" x2="690" y1="107.20000076293945" y2="927.8000106811523" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="signal"><text x="50" y="137.70000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="50">Load 1st sector</tspan></text><line x1="40" x2="210" y1="146.20000076293945" y2="146.20000076293945" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="125" y="171.20000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="125"></tspan></text><line x1="210" x2="40" y1="166.20000076293945" y2="166.20000076293945" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="75" y="187.10000038146973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="75">Jump to</tspan><tspan dy="1.2em" x="75">1st sector</tspan></text><line x1="40" x2="210" y1="224.4000015258789" y2="224.4000015258789" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="225" y="245.30000114440918" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="225">Read rest of</tspan><tspan dy="1.2em" x="225">the image</tspan></text><line x1="210" x2="360" y1="282.60000228881836" y2="282.60000228881836" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="285" y="307.60000228881836" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="285"></tspan></text><line x1="360" x2="210" y1="302.60000228881836" y2="302.60000228881836" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="230" y="323.50000190734863" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="230">Jump to</tspan><tspan dy="1.2em" x="230">GRUB Kernel</tspan></text><line x1="210" x2="360" y1="360.8000030517578" y2="360.8000030517578" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="80" y="391.3000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="80">Fetch system information</tspan></text><line x1="360" x2="40" y1="399.8000030517578" y2="399.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="200" y="424.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="200"></tspan></text><line x1="40" x2="360" y1="419.8000030517578" y2="419.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="255" y="439.8000030517578" width="210" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="260" y="459.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="260">Enter protected mode</tspan></text></g><g class="signal"><text x="220" y="499.3000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="220">Load grub.cfg</tspan></text><line x1="360" x2="210" y1="507.8000030517578" y2="507.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="285" y="532.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="285"></tspan></text><line x1="210" x2="360" y1="527.8000030517578" y2="527.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="275" y="547.8000030517578" width="170" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="280" y="567.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="280">Show boot screen</tspan></text></g><g class="signal"><text x="370" y="607.3000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="370">Load kernel.bin</tspan></text><line x1="360" x2="530" y1="615.8000030517578" y2="615.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="445" y="640.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="445"></tspan></text><line x1="530" x2="360" y1="635.8000030517578" y2="635.8000030517578" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="285" y="655.8000030517578" width="150" height="48.20000076293945" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="290" y="675.8000030517578" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="290">Fill Multiboot</tspan><tspan dy="1.2em" x="290">info table</tspan></text></g><g class="signal"><text x="385" y="724.9000034332275" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="385">Jump to</tspan><tspan dy="1.2em" x="385">krnl_start32</tspan></text><line x1="360" x2="530" y1="762.2000045776367" y2="762.2000045776367" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="385" y="782.2000045776367" width="290" height="86.60000610351562" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="390" y="802.2000045776367" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="390">Perform basic system checks,</tspan><tspan dy="1.2em" x="390">prepare min. environment for</tspan><tspan dy="1.2em" x="390">Rust code, enter long mode</tspan><tspan dy="1.2em" x="390">and far jump to krnl_start64</tspan></text></g><g class="signal"><text x="540" y="899.3000106811523" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="540">Call krnl_main</tspan></text><line x1="530" x2="690" y1="907.8000106811523" y2="907.8000106811523" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>